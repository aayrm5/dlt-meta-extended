[
  {
    "target_table": "cancel_messages_processed",
    "select_exp": [
      "source_file_path",
      "source_modification_time", 
      "ab_success",
      "ab_cancel_type",
      "ab_field_count",
      "ab_parsed_fields[0] as record_type",
      "ab_parsed_fields[1] as message_code",
      "ab_parsed_fields[2] as system_name", 
      "ab_parsed_fields[3] as error_code",
      "ab_parsed_fields[4] as account_number",
      "ab_parsed_fields[5] as transaction_number",
      "ab_parsed_fields[6] as cancel_reason",
      "ab_parsed_fields[7] as amount",
      "ab_parsed_fields[8] as cancel_date",
      "current_timestamp() as processing_timestamp"
    ],
    "where_clause": [
      "ab_success = true",
      "ab_cancel_type is not null"
    ],
    "target_partition_cols": [
      "DATE(processing_timestamp)",
      "ab_cancel_type"
    ]
  }
]